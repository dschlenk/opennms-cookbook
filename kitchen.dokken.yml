---
driver:
  name: dokken
  privileged: true
  chef_image: cincproject/cinc
  chef_version: 18

transport:
  name: dokken

provisioner:
  name: dokken
  project_name: cinc
  download_url: https://omnitruck.cinc.sh/install.sh
  chef_binary: /opt/cinc/bin/cinc-client
  chef_license: accept-no-persist # until https://github.com/test-kitchen/test-kitchen/pull/1984
    # log_level: debug
  attributes:
    opennms:
      conf:
        env:
          START_TIMEOUT: 60
      postgresql:
        user_vault: creds

verifier:
  name: inspec

platforms:
  - name: oraclelinux-9
    driver:
      image: dokken/oraclelinux-9
      pid_one_command: /usr/lib/systemd/systemd

suites:
  - name: recommended
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/recommended
    attributes:
      opennms:
        rrdtool:
          enabled: true
        scv:
          vault: creds
        upgrade: true
        users:
          admin:
            vault: creds
  - name: upgrade
    provisioner:
      policyfile: policyfiles/upgrade.rb
      multiple_converge: 2
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/upgrade
    attributes:
      opennms:
        upgrade: true
  - name: no_upgrade
    provisioner:
      policyfile: policyfiles/upgrade.rb
      multiple_converge: 2
    verifier:
      inspec_tests:
        - path: test/integration/no_upgrade
    attributes:
      opennms:
        upgrade: false
  - name: default
  - name: plugins
    attributes:
      opennms:
        plugin:
          addl: 
            - opennms-plugin-protocol-nsclient
            - opennms-plugin-provisioning-snmp-hardware-inventory
            - opennms-plugin-provisioning-snmp-asset
            - opennms-plugin-northbounder-jms
  - name: snmp_config_definition
    provisioner:
      policyfile: policyfiles/snmp_config_definition.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_definition
  - name: snmp_config_definition_update
    provisioner:
      policyfile: policyfiles/snmp_config_definition_update.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_definition_update
  - name: snmp_config_definition_delete
    provisioner:
      policyfile: policyfiles/snmp_config_definition_delete.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_definition_delete
  - name: snmp_config_profile
    provisioner:
      policyfile: policyfiles/snmp_config_profile.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_profile
  - name: snmp_config_profile_update
    provisioner:
      policyfile: policyfiles/snmp_config_profile_update.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_profile_update
  - name: snmp_config_profile_delete
    provisioner:
      policyfile: policyfiles/snmp_config_profile_delete.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/snmp_config_profile_delete
  - name: eventconf
    provisioner:
      policyfile: policyfiles/eventconf.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/eventconf
  - name: event
    provisioner:
      policyfile: policyfiles/event.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event
  - name: event_add_parameters
    provisioner:
      policyfile: policyfiles/event_add_parameters.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_add_parameters
  - name: event_change_parameters
    provisioner:
      policyfile: policyfiles/event_change_parameters.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_change_parameters
  - name: event_descr
    provisioner:
      policyfile: policyfiles/event_descr.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_descr
  - name: event_edit_alarm_data
    provisioner:
      policyfile: policyfiles/event_edit_alarm_data.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_alarm_data
  - name: event_edit_autoaction
    provisioner:
      policyfile: policyfiles/event_edit_autoaction.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_autoaction
  - name: event_edit_forward
    provisioner:
      policyfile: policyfiles/event_edit_forward.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_forward
  - name: event_edit_mouseovertext
    provisioner:
      policyfile: policyfiles/event_edit_mouseovertext.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_mouseovertext
  - name: event_edit_operinstruct
    provisioner:
      policyfile: policyfiles/event_edit_operinstruct.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_operinstruct
  - name: event_edit_script
    provisioner:
      policyfile: policyfiles/event_edit_script.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_script
  - name: event_edit_tticket
    provisioner:
      policyfile: policyfiles/event_edit_tticket.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_tticket
  - name: event_edit_varbindsdecode
    provisioner:
      policyfile: policyfiles/event_edit_varbindsdecode.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_edit_varbindsdecode
  - name: event_event_label
    provisioner:
      policyfile: policyfiles/event_label.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_label
  - name: event_logmsg
    provisioner:
      policyfile: policyfiles/event_logmsg.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_logmsg
  - name: event_logmsg_dest
    provisioner:
      policyfile: policyfiles/event_logmsg_dest.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_logmsg_dest
  - name: event_logmsg_notify
    provisioner:
      policyfile: policyfiles/event_logmsg_notify.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_logmsg_notify
  - name: event_noop
    provisioner:
      policyfile: policyfiles/event_noop.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_noop
  - name: event_remove_add_alarm_data
    provisioner:
      policyfile: policyfiles/event_remove_add_alarm_data.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_alarm_data
  - name: event_remove_add_autoaction
    provisioner:
      policyfile: policyfiles/event_remove_add_autoaction.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_autoaction
  - name: event_remove_add_forward
    provisioner:
      policyfile: policyfiles/event_remove_add_forward.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_forward
  - name: event_remove_add_script
    provisioner:
      policyfile: policyfiles/event_remove_add_script.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_script
  - name: event_remove_add_tticket
    provisioner:
      policyfile: policyfiles/event_remove_add_tticket.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_tticket
  - name: event_remove_add_varbindsdecode
    provisioner:
      policyfile: policyfiles/event_remove_add_varbindsdecode.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_add_varbindsdecode
  - name: event_remove_alarm_data
    provisioner:
      policyfile: policyfiles/event_remove_alarm_data.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_alarm_data
  - name: event_remove_autoaction
    provisioner:
      policyfile: policyfiles/event_remove_autoaction.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_autoaction
  - name: event_remove_forward
    provisioner:
      policyfile: policyfiles/event_remove_forward.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_forward
  - name: event_remove_script
    provisioner:
      policyfile: policyfiles/event_remove_script.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_script
  - name: event_remove_tticket
    provisioner:
      policyfile: policyfiles/event_remove_tticket.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_tticket
  - name: event_remove_varbindsdecode
    provisioner:
      policyfile: policyfiles/event_remove_varbindsdecode.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_remove_varbindsdecode
  - name: event_severity
    provisioner:
      policyfile: policyfiles/event_severity.rb
    verifier:
      inspec_tests:
        - path: test/integration/default
        - path: test/integration/event_severity
